<html lang="en">
<head>
  <title>App</title>
  <script type="application/javascript" src="https://accounts.google.com/gsi/client"></script>
  <script type="application/javascript" src="https://apis.google.com/js/api.js"></script>
</head>
<body>
  <button id="btn-login">Authorize me</button>
  <script type="application/javascript">
    document.addEventListener('DOMContentLoaded', () => {
      const client = google.accounts.oauth2.initTokenClient({
        client_id: '169826553548-c1o8b8sh7f25qlv1qt026kieucus8r72.apps.googleusercontent.com',
        scope: 'https://www.googleapis.com/auth/userinfo.email \
                https://www.googleapis.com/auth/drive \
                https://www.googleapis.com/auth/spreadsheets',
        callback: function(response) {
          console.log('Authenticated!')
          gapi.load('client:script', function() {
            console.log('Google API Client loaded!')
            gapi.client.setToken(response.access_token)
            console.log('Running script...')
            gapi.client.script.scripts.run({
              scriptId: 'AKfycbxZRwM-SIMNN_vA_P2k1UxRV4iIWNum9CCigujzaZPg',
              resource: {
                devMode: true,
                function: '$router',
                parameters: [{ path: '/users/1' }], } })
            .then(function(response) {
              console.log(response)
            })
          })
        },
      })
      document.querySelector('button#btn-login').addEventListener('click', () => {
        client.requestAccessToken() })
    })
  </script>
</body>
</html>
